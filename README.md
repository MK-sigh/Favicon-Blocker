# Favicon Blocker for Google

Google検索結果に表示される「ファビコン（サイトアイコン）」を基準にして、不要なサイトを視覚的にブロック（グレーアウト）するChrome拡張機能です。
特に、**「見た目が同じファビコン（デフォルトアイコンなど）を使っている大量のスパムサイト」を一網打尽にする機能**を持っています。
  
  
<img width="1107" height="881" alt="検索画面" src="https://github.com/user-attachments/assets/d4ce682e-d167-44da-94ca-ad6e02b6b907" />

## 特徴

*   **見た目でブロック（画像ハッシュ判定）**
    *   URLが微妙に異なっていても、**画像の見た目（データ）が同じであれば全て同一**とみなしてブロックします。これにより、Googleのデフォルトアイコンを使い回すスパムサイト群を一括で非表示にできます。
*   **右クリックで簡単登録**
    *   検索結果の画像を右クリックし、メニューから選ぶだけでブロックリストに追加できます。邪魔なボタン表示はありません。
*   **安全なブロック範囲（巻き添え防止）**
    *   独自のアルゴリズムにより、個別の検索結果カード（末端）だけを正確に特定します。「まとめ枠」や「隣のサイト」を誤って巻き込んでグレーアウトすることを物理的に防いでいます。
*   **許可リスト機能**
    *   特定のドメイン（例: `wikipedia.org`）を許可リストに登録しておけば、たとえブロック対象のファビコンを使っていても表示され続けます。

## インストール方法

この拡張機能はChromeウェブストアには公開していないため、「デベロッパーモード」を使ってインストールします。

1.  任意のフォルダ（例: `favicon-blocker`）を作成し、以下のファイルを配置してください。
    *   `manifest.json`
    *   `background.js`
    *   `content.js`
    *   `styles.css`
    *   `popup.html`
    *   `popup.js`
    *   `icon.png` (任意: 48x48px程度のアイコン画像)
2.  Google Chromeを開き、URLバーに `chrome://extensions/` と入力します。
3.  右上の **「デベロッパーモード」** をオンにします。
4.  左上の **「パッケージ化されていない拡張機能を読み込む」** をクリックします。
5.  **手順1** で作成したフォルダを選択します。

## 使い方

### 1. サイトをブロックする
1.  Google検索を行います。
2.  ブロックしたいサイトの **ファビコン（またはサムネイル画像）** の上にマウスカーソルを合わせます。
3.  **右クリック** します。
4.  メニューから **「🚫 このファビコン（見た目）をブロック」** を選択します。
5.  確認ダイアログが出るので「OK」を押します。
6.  ページ内の該当するサイトがすべてグレーアウトされます。

### 2. ブロックを解除する
*   グレーアウトされた領域に表示されている **「解除する」** ボタンをクリックすると、そのファビコンのブロック設定が解除され、再読み込みされます。
*   または、拡張機能のアイコンをクリックして設定画面（ポップアップ）を開き、ブロックリストから個別に削除できます。

### 3. 許可リストの設定
特定のサイトをブロックしたくない場合は、ホワイトリストに登録します。

1.  ブラウザ右上の拡張機能アイコンをクリックします。
2.  「許可するサイト」の欄に、ドメインやURLの一部（例: `amazon.co.jp`）を入力します。
3.  「保存」をクリックします。

## ファイル構成と役割

| ファイル名 | 役割 |
| :--- | :--- |
| `manifest.json` | 拡張機能の定義ファイル。権限設定(`<all_urls>`, `contextMenus`)など。 |
| `background.js` | **中枢機能**。画像のダウンロード、ハッシュ値（指紋）の計算、右クリックメニューの制御を担当。 |
| `content.js` | **画面制御**。検索結果ページで画像を特定し、ブロック枠（オーバーレイ）を表示する。巻き添え防止ロジックを含む。 |
| `styles.css` | ブロック時のグレーアウト表示（オーバーレイ）のデザイン定義。`overflow: hidden` で画面崩れを防止。 |
| `popup.html` | 設定画面のレイアウト。 |
| `popup.js` | 設定画面の保存・読み込み処理。 |

## 注意事項

*   **タイムラグについて**
    *   画像の見た目（データ）を確認するためにバックグラウンド通信を行うため、ページを開いてからブロックが適用されるまでに 0.5秒〜1秒程度のタイムラグが発生することがあります。
*   **Googleの仕様変更**
    *   Google検索のHTML構造が大幅に変更された場合、ブロック範囲の特定ロジックが動作しなくなる可能性があります。その際は `content.js` の修正が必要です。
